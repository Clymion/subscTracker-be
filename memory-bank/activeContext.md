# Active Context

## Current work focus
- エラー共通処理の実装とリファクタリング完了
- 認証関連APIの仮実装にTODOコメントを追加し、将来的な本格実装の必要性を明示
- テスト共通処理の実装完了（フィクスチャ、モック、環境初期化）

## Recent changes
- app/constants.pyにエラーメッセージの集中管理クラスを追加
- app/common/error_handlers.pyにFlask用共通エラーハンドラーを実装し、型付けとdocstringを追加
- app/api/v1/auth.pyに認証APIの仮実装を追加し、TODOコメントで仮実装であることを明示
- tests/common/conftest.pyにテスト共通処理のpytestフィクスチャを実装

## Next steps
- ログ設計とロギング機能（リクエスト・レスポンスログ、エラーログ、ログレベル設定）の実装完了
- 共通処理の他の部分（環境設定管理、認証・認可共通処理、APIレスポンス共通処理）の設計と実装
- 認証・ユーザー関連APIの本格実装
- サブスクリプション管理APIの実装

## Active decisions and considerations
- 実装優先順位は以下の通り
  1. 共通処理の実装
    1.1 エラー共通処理（標準エラーフォーマット、例外ハンドリング、エラー分類）【完了】
    1.2 ログ設計とロギング機能（リクエスト・レスポンスログ、エラーログ、ログレベル設定）【完了】
    1.3 テスト共通処理（フィクスチャ、モック、環境初期化）【完了】
    1.4 環境設定管理（.envファイル読み込み、デフォルト値設定、バリデーション、pydantic-settings利用）
    1.5 認証・認可共通処理（JWT検証、権限チェック）
    1.6 APIレスポンス共通処理（成功レスポンス統一、ページネーション処理）
  2. 認証・ユーザー関連APIの実装
  3. サブスクリプション管理APIの実装
  4. 支払い履歴管理APIの実装
  5. 設定関連APIの実装
  6. 通知サブシステムの実装
- エラー共通処理は集中管理と標準化を重視し、Flaskのエラーハンドラーで統一的に処理
- 認証APIは現状仮実装であり、今後の拡張を見据えた設計が必要
